<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Group Data in Time Intervals — hsGroupByInterval • kwb.base</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Group Data in Time Intervals — hsGroupByInterval" />
<meta property="og:description" content="Builds groups of rows belonging to the same time interval and aggregates the
values within the group by using a given function (e.g. sum, mean, min, max)" />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.base</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KWB-R/kwb.base">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Group Data in Time Intervals</h1>
    <small class="dont-index">Source: <a href='https://github.com/KWB-R/kwb.base/blob/master/R/hsLibBase.R'><code>R/hsLibBase.R</code></a></small>
    <div class="hidden name"><code>hsGroupByInterval.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Builds groups of rows belonging to the same time interval and aggregates the
values within the group by using a given function (e.g. sum, mean, min, max)</p>
    </div>

    <pre class="usage"><span class='fu'>hsGroupByInterval</span>(<span class='no'>data</span>, <span class='no'>interval</span>, <span class='no'>FUN</span>, <span class='kw'>tsField</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>data</span>)[<span class='fl'>1</span>],
  <span class='kw'>offset1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>offset2</span> <span class='kw'>=</span> <span class='no'>interval</span>/<span class='fl'>2</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>,
  <span class='kw'>dbg</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>data frame containing a timestamp field and data fields to be
aggregated over time.</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>length of time interval in seconds</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>function used to aggregate the values within one and the same
interval, e.g. sum, mean, min, max</p></td>
    </tr>
    <tr>
      <th>tsField</th>
      <td><p>name of timestamp column, default: name of first column</p></td>
    </tr>
    <tr>
      <th>offset1</th>
      <td><p>number of seconds by which all timestamps are shifted before
they are grouped into intervals. The grouping to intervals is done by
dividing the timestamps (converted to number of seconds since 1970-01-01)
by the interval length and taking the integer part of the division as
interval number. Thus, with offset1 = 0 and an interval length of e.g. 60
seconds, the first interval is from 00:00:00 to 00:00:59, the second from
00:01:00 to 00:01:59 etc., whereas offset1 = 30 in this case would lead to
intervals 00:00:30 to 00:01:29, 00:01:30 to 00:02:29 etc..</p></td>
    </tr>
    <tr>
      <th>offset2</th>
      <td><p>value given in seconds determining which of the timestamps in
an interval represents the interval in the output. If 0, each time interval
is represented by the smallest timestamp belonging to the interval. By
default, offset2 is half the interval length, meaning that each time
interval is represented by the timestamp in the middle of the interval.</p></td>
    </tr>
    <tr>
      <th>limits</th>
      <td><p>if TRUE, two additional columns will be added showing the
minimum and maximum value of the interval</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments passed to aggregate, the internally called
function</p></td>
    </tr>
    <tr>
      <th>dbg</th>
      <td><p>if TRUE, debug messages are shown</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Get an example time-series with values every one minute</span>
<span class='no'>step</span> <span class='kw'>&lt;-</span> <span class='fl'>60</span>
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='hsExampleTSeries.html'>hsExampleTSeries</a></span>(<span class='no'>step</span>)

<span class='co'>## Calculate 5-min-means with</span>
<span class='co'>## offset1 = 0 (default), offset2 = interval/2 (default)</span>
<span class='no'>df.agg1</span> <span class='kw'>&lt;-</span> <span class='fu'>hsGroupByInterval</span>(<span class='no'>df</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>5</span>*<span class='no'>step</span>, <span class='no'>mean</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>df.agg1</span></div><div class='output co'>#&gt;                     t               t.beg               t.end             y
#&gt; 1 2012-01-01 12:02:30 2012-01-01 12:00:00 2012-01-01 12:04:59  5.313752e-01
#&gt; 2 2012-01-01 12:07:30 2012-01-01 12:05:00 2012-01-01 12:09:59  7.313752e-01
#&gt; 3 2012-01-01 12:12:30 2012-01-01 12:10:00 2012-01-01 12:14:59 -5.313752e-01
#&gt; 4 2012-01-01 12:17:30 2012-01-01 12:15:00 2012-01-01 12:19:59 -7.313752e-01
#&gt; 5 2012-01-01 12:22:30 2012-01-01 12:20:00 2012-01-01 12:24:59 -2.449294e-16</div><div class='input'>
<span class='co'>## Shift the interval limits with</span>
<span class='co'>## offset1 = 2.5*60, offset2 = interval/2 (default)</span>
<span class='no'>df.agg2</span> <span class='kw'>&lt;-</span> <span class='fu'>hsGroupByInterval</span>(<span class='no'>df</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>5</span>*<span class='no'>step</span>, <span class='no'>mean</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                             <span class='kw'>offset1</span> <span class='kw'>=</span> <span class='fl'>2.5</span>*<span class='no'>step</span>)
<span class='no'>df.agg2</span></div><div class='output co'>#&gt;                     t               t.beg               t.end             y
#&gt; 1 2012-01-01 12:00:00 2012-01-01 11:57:30 2012-01-01 12:02:29  2.989341e-01
#&gt; 2 2012-01-01 12:05:00 2012-01-01 12:02:30 2012-01-01 12:07:29  9.040294e-01
#&gt; 3 2012-01-01 12:10:00 2012-01-01 12:07:30 2012-01-01 12:12:29  1.910147e-16
#&gt; 4 2012-01-01 12:15:00 2012-01-01 12:12:30 2012-01-01 12:17:29 -9.040294e-01
#&gt; 5 2012-01-01 12:20:00 2012-01-01 12:17:30 2012-01-01 12:22:29 -2.989341e-01</div><div class='input'>
<span class='co'>## Shift the timestamps representing the intervals with</span>
<span class='co'>## offset1 = 0, offset2 = 0</span>
<span class='no'>df.agg3</span> <span class='kw'>&lt;-</span> <span class='fu'>hsGroupByInterval</span>(<span class='no'>df</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>5</span>*<span class='no'>step</span>, <span class='no'>mean</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                             <span class='kw'>offset1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>offset2</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='no'>df.agg3</span></div><div class='output co'>#&gt;                     t               t.beg               t.end             y
#&gt; 1 2012-01-01 12:00:00 2012-01-01 12:00:00 2012-01-01 12:04:59  5.313752e-01
#&gt; 2 2012-01-01 12:05:00 2012-01-01 12:05:00 2012-01-01 12:09:59  7.313752e-01
#&gt; 3 2012-01-01 12:10:00 2012-01-01 12:10:00 2012-01-01 12:14:59 -5.313752e-01
#&gt; 4 2012-01-01 12:15:00 2012-01-01 12:15:00 2012-01-01 12:19:59 -7.313752e-01
#&gt; 5 2012-01-01 12:20:00 2012-01-01 12:20:00 2012-01-01 12:24:59 -2.449294e-16</div><div class='input'>
<span class='co'>## Show a plot demonstrating the effect of offset1 and offset2</span>
<span class='fu'><a href='demoGroupByInterval.html'>demoGroupByInterval</a></span>(<span class='no'>df</span>)</div><div class='output co'>#&gt; Running command: &gt;&gt;&gt;"false" "/tmp/Rtmp9C6QlT/file5f7a5701e6bf.pdf"&lt;&lt;&lt;</div><div class='input'>
<span class='co'>## Handling NA values...</span>

<span class='co'>## Set y to NA at 2 random positions</span>
<span class='no'>df</span>[<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>df</span>), <span class='fl'>2</span>), <span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>df</span> <span class='co'>## Let' have a look at df</span></div><div class='output co'>#&gt;                      t             y
#&gt; 1  2012-01-01 12:00:00  0.000000e+00
#&gt; 2  2012-01-01 12:01:00  3.090170e-01
#&gt; 3  2012-01-01 12:02:00  5.877853e-01
#&gt; 4  2012-01-01 12:03:00  8.090170e-01
#&gt; 5  2012-01-01 12:04:00  9.510565e-01
#&gt; 6  2012-01-01 12:05:00  1.000000e+00
#&gt; 7  2012-01-01 12:06:00  9.510565e-01
#&gt; 8  2012-01-01 12:07:00  8.090170e-01
#&gt; 9  2012-01-01 12:08:00  5.877853e-01
#&gt; 10 2012-01-01 12:09:00  3.090170e-01
#&gt; 11 2012-01-01 12:10:00  1.224647e-16
#&gt; 12 2012-01-01 12:11:00            NA
#&gt; 13 2012-01-01 12:12:00            NA
#&gt; 14 2012-01-01 12:13:00 -8.090170e-01
#&gt; 15 2012-01-01 12:14:00 -9.510565e-01
#&gt; 16 2012-01-01 12:15:00 -1.000000e+00
#&gt; 17 2012-01-01 12:16:00 -9.510565e-01
#&gt; 18 2012-01-01 12:17:00 -8.090170e-01
#&gt; 19 2012-01-01 12:18:00 -5.877853e-01
#&gt; 20 2012-01-01 12:19:00 -3.090170e-01
#&gt; 21 2012-01-01 12:20:00 -2.449294e-16</div><div class='input'>
<span class='co'>## Count NA values per group</span>
<span class='fu'>hsGroupByInterval</span>(<span class='no'>df</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='kw'>function</span>(<span class='no'>x</span>){<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>x</span>))})</div><div class='output co'>#&gt;                     t y
#&gt; 1 2012-01-01 12:02:30 0
#&gt; 2 2012-01-01 12:07:30 0
#&gt; 3 2012-01-01 12:12:30 2
#&gt; 4 2012-01-01 12:17:30 0
#&gt; 5 2012-01-01 12:22:30 0</div><div class='input'>
<span class='co'>## default behaviour: mean(values containing at least one NA) = NA</span>
<span class='fu'>hsGroupByInterval</span>(<span class='no'>df</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='no'>mean</span>)</div><div class='output co'>#&gt;                     t             y
#&gt; 1 2012-01-01 12:02:30  5.313752e-01
#&gt; 2 2012-01-01 12:07:30  7.313752e-01
#&gt; 3 2012-01-01 12:12:30            NA
#&gt; 4 2012-01-01 12:17:30 -7.313752e-01
#&gt; 5 2012-01-01 12:22:30 -2.449294e-16</div><div class='input'>
<span class='co'>## ignore NA values by passing na.rm = TRUE to the aggregate function</span>
<span class='fu'>hsGroupByInterval</span>(<span class='no'>df</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='no'>mean</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;                     t             y
#&gt; 1 2012-01-01 12:02:30  5.313752e-01
#&gt; 2 2012-01-01 12:07:30  7.313752e-01
#&gt; 3 2012-01-01 12:12:30 -5.866912e-01
#&gt; 4 2012-01-01 12:17:30 -7.313752e-01
#&gt; 5 2012-01-01 12:22:30 -2.449294e-16</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hauke Sonnenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '4772493557078699a02880258ace2686',
    indexName: 'kwb_base',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


